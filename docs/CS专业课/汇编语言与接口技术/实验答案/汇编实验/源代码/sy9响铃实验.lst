Microsoft (R) Macro Assembler Version 6.11		    10/24/22 12:09:19
tempfile.asm						     Page 1 - 1


 0000				data SEGMENT 
 0000 70 6C 65 61 73 65			ts DB 'please input:$' 
       20 69 6E 70 75 74
       3A 24
 000E 0A 0D 70 72 65 73			again DB 0ah,0dh,'press ctrl+C to end,else again:$' 
       73 20 63 74 72 6C
       2B 43 20 74 6F 20
       65 6E 64 2C 65 6C
       73 65 20 61 67 61
       69 6E 3A 24
 0030				data ENDS 

 0000				code SEGMENT 
					ASSUME CS:code,DS:data 
 0000				start: 
					;加载数据段
 0000  B8 ---- R			MOV AX,data  
 0003  8E D8				MOV DS,AX 
 0005				again1:
 0005  8D 16 0000 R			LEA DX,ts 
 0009  B4 09				MOV AH,09h ;显示输出提示字符串 
 000B  CD 21				INT 21h 
					
 000D  B4 01				MOV AH,01h ;调用01号功能接收字符 
 000F  CD 21				INT 21h 
 0011  3C 31				CMP AL,'1' ;与1的ASCll比较，小于则转移 
 0013  72 19				JB restart 
 0015  3C 39				CMP AL,'9' ;与9比较，大于则转移 
 0017  77 15				JA restart  
					
 0019  2C 30				SUB AL,30h ;将ASCll码转换为数字 
 001B  32 E4				XOR AH,AH ;将AX高八位清零，此时AX中的数字为接收的数字 
 001D  8B E8				MOV BP,AX ;将AX的值赋给BP以控制循环 
 001F				BELL:
 001F  B4 02				MOV AH,02 ;响铃程序段 
 0021  B2 07				MOV DL,07 
 0023  CD 21				INT 21H 
					;延时
 0025  E8 002E				CALL delayp
 0028  4D				DEC BP ;BP-1
 0029  83 FD 30				CMP BP,30H
 002C  75 F1				JNZ BELL 	;不等于0时跳转继续循环
				 
 002E				restart:
 002E  8D 16 000E R			LEA DX,again ;提示是否再次运行本程序 
 0032  B4 09				MOV AH,09h 
 0034  CD 21				INT 21h  
 0036  B4 01				MOV AH,01h ;接收字符 
 0038  CD 21				INT 21h 
 003A  E8 0008				CALL CRLF
 003D  3C 03				CMP AL,3 ;CTRL+C对应ascll为3，不相同则继续循环
 003F  75 C4				JNZ again1

 0041  B4 4C			MOV AH,4ch 
 0043  CD 21			INT 21h 

				;换行函数
 0045				CRLF    PROC    near 
 0045  52				PUSH DX ;保护之前的数据
 0046  50				PUSH AX                    
 0047  B2 0D				MOV DL,0DH
 0049  B4 02			    MOV AH,02H
 004B  CD 21			    INT 21H       ;光标移到第一列              
 004D  B2 0A			    MOV DL,0AH
 004F  B4 02			    MOV AH,02H
 0051  CD 21			    INT 21H       ;光标移到下一行
 0053  58			    POP AX
 0054  5A				POP DX             
 0055  C3			    RET
 0056				CRLF ENDP

 0056				DELAYP PROC
 0056  52				push dx
 0057  51				push cx
 0058  50				push ax ;保存数据
					
 0059  B4 2D				MOV AH, 2DH ;2DH，设置系统时间,初始为0
 005B  B9 0000			    MOV CX, 0
 005E  BA 0000			    MOV DX, 0
 0061  CD 21			    INT 21H
 0063				READ:  
 0063  B4 2C				MOV AH, 2CH ;查询系统时间
 0065  CD 21			    INT 21H

 0067  B0 64			    MOV AL, 100 ;=100D
 0069  F6 E6			    MUL DH 		;AL=DH*100
 006B  B6 00			    MOV DH, 0 
 006D  03 C2			    ADD AX, DX  ;Ax=当前秒数*100
 006F  83 F8 64			    CMP AX, 100  ;=100时结束，不产生进位或借位
 0072  72 EF			    JC  READ

 0074  58				pop ax ;恢复数据
 0075  59				pop cx
 0076  5A				pop dx
 0077  C3			    RET
 0078				DELAYP ENDP

 0078				code ENDS 
				END start 

Microsoft (R) Macro Assembler Version 6.11		    10/24/22 12:09:19
tempfile.asm						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

code . . . . . . . . . . . . . .	16 Bit	 0078	  Para	  Private 
data . . . . . . . . . . . . . .	16 Bit	 0030	  Para	  Private 


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

CRLF . . . . . . . . . . . . . .	P Near	 0045	  code	Length= 0011 Public
DELAYP . . . . . . . . . . . . .	P Near	 0056	  code	Length= 0022 Public
  READ . . . . . . . . . . . . .	L Near	 0063	  code	


Symbols:

                N a m e                 Type     Value    Attr

BELL . . . . . . . . . . . . . .	L Near	 001F	  code	
again1 . . . . . . . . . . . . .	L Near	 0005	  code	
again  . . . . . . . . . . . . .	Byte	 000E	  data	
restart  . . . . . . . . . . . .	L Near	 002E	  code	
start  . . . . . . . . . . . . .	L Near	 0000	  code	
ts . . . . . . . . . . . . . . .	Byte	 0000	  data	

	   0 Warnings
	   0 Errors
